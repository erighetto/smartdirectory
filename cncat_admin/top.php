<?php 	if (!defined("ADMIN_INTERFACE")){		die();	}?><html><head>    <title>CNCat :: <?php print $CNCAT["lang"]["administration"]?></title>    <meta http-equiv="Content-Type" content="text/html; charset=<?php print $CNCAT["lang"]["charset"]?>">    <?php print $CNCAT_ENGINE->render->includeStyle('admin.css')?>    <?php print $CNCAT_ENGINE->render->includeStyle('admin-categories.css')?>    <?php print $CNCAT_ENGINE->render->includeScript('jquery/jquery.js')?>    <?php print $CNCAT_ENGINE->render->includeScript('jquery/jquery.cookie.js')?>    <script type="text/javascript">    $(document).ready(function() {        $('#settings_list_title').click(function () { $('#settings_list_toggle').click(); });        $('#settings_list_toggle').toggle(<?php    $callbacks = array(        "function () {\n"            . "\$(this).attr('src', '" . $CNCAT["abs"] . $CNCAT["system"]["dir_engine_images"] . "expand.gif');\n"            . "\$('#settings_list').css('display', 'block');\n"            . "\$.cookie('settings_list_toggle', '1', { expires: 30 });\n"            . "}\n",        "function () {\n"            . "\$(this).attr('src', '" . $CNCAT["abs"] . $CNCAT["system"]["dir_engine_images"] . "collapse.gif');\n"            . "\$('#settings_list').css('display', 'none');\n"            . "\$.cookie('settings_list_toggle', '0', { expires: 30 });\n"            . "}\n",    );    if (empty($_COOKIE['settings_list_toggle'])) {        print $callbacks[0] . ', ' . $callbacks[1];    } else {        print $callbacks[1] . ', ' . $callbacks[0];    }?>        );    });    </script></head><body><div id="clear"></div><table id="main">    <tr><td id="left">        <table id="menu">            <tr><td class="title">CNCat <?php print $CNCAT_PRODUCT_VERSION?></td></tr>            <tr><td class="block">                <ul>                     <li>                        <a href="<?php print $CNCAT["config"]["cncat_url"]?>"><?php print $CNCAT["lang"]["catalog"]?></a>                    </li><?php$manual_lang = "en";if (in_array(substr($CNCAT["config"]["language"], 0, 2), array("ru", "ua"))) {    $manual_lang = "ru";}?>                    <li><a href="index.php?act=docs&lang=<?php print $manual_lang?>"><?php print $CNCAT["lang"]["documentation"]?></a></li>                    <?php                    if ($manual_lang == "ru") {                        print "<li><a href=\"http://www.cn-software.com/forum/forumdisplay.php?f=13\" target=\"blank\">" . $CNCAT["lang"]["forum"] . "</a></li>";                    }                    ?>                    <li><a href="index.php?act=logout"><?php print $CNCAT["lang"]["logout"]?></a></li>                </ul>            </td></tr>            <tr><td style="height: 10px;"></td></tr>            <tr><td class="title"><?php print $CNCAT["lang"]["links_and_articles"]?></td></tr>            <tr><td class="block">                <ul><?phpif (isAdmin()) {    $query = "SELECT `item_status`, COUNT(*) AS `count`    FROM `" . $CNCAT["config"]["db"]["prefix"] . "items`    FORCE INDEX (status)    GROUP BY `item_status`";} else {    $query = "SELECT `item_status`, COUNT(*) AS `count`        FROM `" . $CNCAT["config"]["db"]["prefix"] . "itemcat`        FORCE INDEX (item_status)        WHERE `cat_id` IN (" . join(",", getModerCats()) . ")        GROUP BY `item_status`";}$res = $CNCAT_ENGINE->db->query($query) or $CNCAT_ENGINE->displayErrorDB(mysql_error());$counts = array(0, 0, 0, 4 => 0, 5 => 0);while ($row = mysql_fetch_assoc($res)) {    $counts[$row["item_status"]] = $row["count"];}?>                    <li><?php if ($_GET["act"] == "links" && $_GET["type"] == 0) {?>                        <?php print $CNCAT["lang"]["links_0"]?> (<span id="links0_count"><?php print $counts[0]?></span>)                    <?php } else {?>                        <a href="index.php?act=links&type=0"><?php print $CNCAT["lang"]["links_0"]?> (<span id="links0_count"><?php print $counts[0]?></span>)</a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "links" && $_GET["type"] == 1) {?>                        <?php print $CNCAT["lang"]["links_1"]?> (<span id="links1_count"><?php print $counts[1]?></span>)                    <?php } else {?>                        <a href="index.php?act=links&type=1"><?php print $CNCAT["lang"]["links_1"]?> (<span id="links1_count"><?php print $counts[1]?></span>)</a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "links" && $_GET["type"] == 2) {?>                        <?php print $CNCAT["lang"]["links_2"]?> (<span id="links2_count"><?php print $counts[2]?></span>)                    <?php } else {?>                        <a href="index.php?act=links&type=2"><?php print $CNCAT["lang"]["links_2"]?> (<span id="links2_count"><?php print $counts[2]?></span>)</a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "links" && $_GET["type"] == 5) {?>                        <?php print $CNCAT["lang"]["do_isolation"]?> (<span id="links5_count"><?php print $counts[5]?></span>)                    <?php } else {?>                        <a href="index.php?act=links&type=5"><?php print $CNCAT["lang"]["do_isolation"]?> (<span id="links5_count"><?php print $counts[5]?></span>)</a>                    <?php }?></li>                <?php if (isAdmin()) {?>                    <li><?php if ($_GET["act"] == "links" && $_GET["type"] == 4) {?>                        <?php print $CNCAT["lang"]["links_4"]?> (<span id="links4_count"><?php print $counts[4]?></span>)                    <?php } else {?>                        <a href="index.php?act=links&type=4"><?php print $CNCAT["lang"]["links_4"]?> (<span id="links4_count"><?php print $counts[4]?></span>)</a>                    <?php }?></li>                <?php }?><?php$cond = array("`link_broken_warning`=1");if (isAdmin()) {    $broken_count = getItemsCount($cond);} else {    if ($items_id = getItemsByCat(array("`cat_id` IN (" . join(",", getModerCats()) . ")"))) {        $cond[] = "`item_id` IN (" . join(",", $items_id) . ")";        $broken_count = getItemsCount($cond);    } else {        $broken_count = 0;    }}?>                    <li><?php if ($_GET["act"] == "broken") {?>                        <?php print $CNCAT["lang"]["links_broken"]?> (<span id="broken_count"><?php print $broken_count?></span>)                    <?php } else {?>                        <a href="index.php?act=broken"><?php print $CNCAT["lang"]["links_broken"]?> (<span id="broken_count"><?php print $broken_count?></span>)</a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "dups") {?>                        <?php print $CNCAT["lang"]["links_dups"]?>                    <?php } else {?>                        <a href="index.php?act=dups"><?php print $CNCAT["lang"]["links_dups"]?></a>                    <?php }?></li>                                        <li style="padding-top: 8px;"><?php if ($_GET["act"] == "search") {?>                        <?php print $CNCAT["lang"]["search"]?>                    <?php } else {?>                        <a href="index.php?act=search"><?php print $CNCAT["lang"]["search"]?></a>                    <?php }?></li><?php$query = "SELECT COUNT(*) AS `count` FROM `" . $CNCAT["config"]["db"]["prefix"] . "linkcheck`    WHERE `moder_id`=" . (isModer() ? getModerId() : 0) . " AND `check_flag`=0";$res = $CNCAT_ENGINE->db->query($query) or $CNCAT_ENGINE->displayErrorDB(mysql_error());$row = mysql_fetch_assoc($res);$check_count = (int)$row["count"];?>                    <li style="padding-bottom: 10px;"><?php if ($_GET["act"] == "check") {?>                        <?php print $CNCAT["lang"]["proccess"]?> (<span id="check_count"><?php print $check_count?></span>)                    <?php } else {?>                        <a href="index.php?act=check"><?php print $CNCAT["lang"]["proccess"]?> (<span id="check_count"><?php print $check_count?></span>)</a>                    <?php }?></li>                                        <li><?php if ($_GET["act"] == "links_add") {?>                        <?php print $CNCAT["lang"]["links_addition"]?>                    <?php } else {?>                        <a href="index.php?act=links_add"><?php print $CNCAT["lang"]["links_addition"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "articles_add") {?>                        <?php print $CNCAT["lang"]["article_addition"]?>                    <?php } else {?>                        <a href="index.php?act=articles_add"><?php print $CNCAT["lang"]["article_addition"]?></a>                    <?php }?></li>                </ul>            </td></tr>            <tr><td style="height: 10px;"></td></tr>            <tr><td class="title"><?php print $CNCAT["lang"]["catalogue_elements"]?></td></tr>            <tr><td class="block">                <ul>                    <li><?php if ($_GET["act"] == "cats") {?>                        <?php print $CNCAT["lang"]["categories"]?>                    <?php } else {?>                        <a href="index.php?act=cats"><?php print $CNCAT["lang"]["categories"]?></a>                    <?php }?></li>                          <?php if (isAdmin()) {?>                    <li><?php if ($_GET["act"] == "filters") {?>                        <?php print $CNCAT["lang"]["filters"]?>                    <?php } else {?>                        <a href="index.php?act=filters"><?php print $CNCAT["lang"]["filters"]?></a>                    <?php }?></li>                    <li><a href="#" onclick="window.open('<?php print $CNCAT["abs"] . $CNCAT["system"]["dir_admin"] ?>image_browser.php','browser','scrollbars=no,width=670,height=590,top='+((screen.height-550)/2)+',left='+((screen.width-790)/2));"><?php print $CNCAT["lang"]["images"]?></a></li>                    <?php }?>                <?php if (isAdmin()) {?>                    <li><?php if ($_GET["act"] == "banners") {?>                        <?php print $CNCAT["lang"]["banners"]?>                    <?php } else {?>                        <a href="index.php?act=banners"><?php print $CNCAT["lang"]["banners"]?></a>                    <?php }?></li>                <?php }?>                <?php if (isAdmin()) {?><?php$query = "SELECT COUNT(*) AS `count` FROM `" . $CNCAT["config"]["db"]["prefix"] . "comments`    WHERE `active` = 0";$result = $CNCAT_ENGINE->db->query($query) or $CNCAT_ENGINE->displayErrorDB(mysql_error());$row = mysql_fetch_assoc($result);$new_com_count = intval($row["count"]);?>                    <li><?php if ($_GET["act"] == "comments") {?>                        <?php print $CNCAT["lang"]["comments"]?> (<?php print $new_com_count?>)                    <?php } else {?>                        <a href="index.php?act=comments"><?php print $CNCAT["lang"]["comments"]?> (<?php print $new_com_count?>)</a>                    <?php }?></li>                <?php }?>                </ul>            </td></tr>            <?php if (isAdmin()) {?>            <tr><td style="height: 10px;"></td></tr>            <tr><td class="title" id="settings_list_title">                <div style="float: right;">                    <img src="<?php print $CNCAT["abs"] . $CNCAT["system"]["dir_engine_images"]?><?php print empty($_COOKIE["settings_list_toggle"]) ? "collapse.gif" : "expand.gif"?>" id="settings_list_toggle" />                </div>                <?php print $CNCAT["lang"]["settings"]?>            </td></tr>            <tr><td class="block">                <ul id="settings_list" <?php print empty($_COOKIE["settings_list_toggle"]) ? "style=\"display: none;\"" : ""?>>                    <li><?php if ($_GET["act"] == "general_opt") {?>                        <?php print $CNCAT["lang"]["settings_general"]?>                    <?php } else {?>                        <a href="index.php?act=general_opt"><?php print $CNCAT["lang"]["settings_general"]?></a>                    <?php }?></li>                                        <li><?php if ($_GET["act"] == "urls_opt") {?>                        <?php print $CNCAT["lang"]["settings_urls"]?>                    <?php } else {?>                        <a href="index.php?act=urls_opt"><?php print $CNCAT["lang"]["settings_urls"]?></a>                    <?php }?></li>                                        <li><?php if ($_GET["act"] == "product_opt") {?>                        <?php print $CNCAT["lang"]["settings_product"]?>                    <?php } else {?>                        <a href="index.php?act=product_opt"><?php print $CNCAT["lang"]["settings_product"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "articles_opt") {?>                        <?php print $CNCAT["lang"]["articles"]?>                    <?php } else {?>                        <a href="index.php?act=articles_opt"><?php print $CNCAT["lang"]["articles"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "comments_opt") {?>                        <?php print $CNCAT["lang"]["comments"]?>                    <?php } else {?>                        <a href="index.php?act=comments_opt"><?php print $CNCAT["lang"]["comments"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "ext_fields") {?>                        <?php print $CNCAT["lang"]["extended_fields"]?>                    <?php } else {?>                        <a href="index.php?act=ext_fields"><?php print $CNCAT["lang"]["extended_fields"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "rss_opt") {?>                        <?php print $CNCAT["lang"]["rss_feed"]?>                    <?php } else {?>                        <a href="index.php?act=rss_opt"><?php print $CNCAT["lang"]["rss_feed"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "check_opt") {?>                        <?php print $CNCAT["lang"]["settings_check"]?>                    <?php } else {?>                        <a href="index.php?act=check_opt"><?php print $CNCAT["lang"]["settings_check"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "cron") {?>                        <?php print $CNCAT["lang"]["check_by_schedule"]?>                    <?php } else {?>                        <a href="index.php?act=cron"><?php print $CNCAT["lang"]["check_by_schedule"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "notify_opt") {?>                        <?php print $CNCAT["lang"]["settings_mail_notify"]?>                    <?php } else {?>                        <a href="index.php?act=notify_opt"><?php print $CNCAT["lang"]["settings_mail_notify"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "jumps_opt") {?>                        <?php print $CNCAT["lang"]["settings_jumps_security"]?>                    <?php } else {?>                        <a href="index.php?act=jumps_opt"><?php print $CNCAT["lang"]["settings_jumps_security"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "backlinks") {?>                        <?php print $CNCAT["lang"]["backlinks"]?>                    <?php } else {?>                        <a href="index.php?act=backlinks"><?php print $CNCAT["lang"]["backlinks"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "bwlist") {?>                        <?php print $CNCAT["lang"]["bwlist"]?>                    <?php } else {?>                        <a href="index.php?act=bwlist"><?php print $CNCAT["lang"]["bwlist"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "moders") {?>                        <?php print $CNCAT["lang"]["moders"]?>                    <?php } else {?>                        <a href="index.php?act=moders"><?php print $CNCAT["lang"]["moders"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "counters") {?>                        <?php print $CNCAT["lang"]["counters"]?>                    <?php } else {?>                        <a href="index.php?act=counters"><?php print $CNCAT["lang"]["counters"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "service") {?>                        <?php print $CNCAT["lang"]["service"]?>                    <?php } else {?>                        <a href="index.php?act=service"><?php print $CNCAT["lang"]["service"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "import") {?>                        <?php print $CNCAT["lang"]["import"]?>                    <?php } else {?>                        <a href="index.php?act=import"><?php print $CNCAT["lang"]["import"]?></a>                    <?php }?></li>                    <li><?php if ($_GET["act"] == "export") {?>                        <?php print $CNCAT["lang"]["export"]?>                    <?php } else {?>                        <a href="index.php?act=export"><?php print $CNCAT["lang"]["export"]?></a>                    <?php }?></li>                </ul>            </td></tr>            <?php }?>            <tr><td style="height: 10px;"></td></tr><?php$plugins_list = array();$dh = opendir($CNCAT["system"]["dir_root"] . $CNCAT["system"]["dir_admin"] . "plugins");while (($dir = readdir($dh)) !== false) {    if ($dir == "." || $dir == "..") {        continue;    }    $plugin_dir = $CNCAT["system"]["dir_root"] . $CNCAT["system"]["dir_admin"] . "plugins/" . $dir;    require_once $plugin_dir . "/info.php";    $plugins_list[] = array(        "act"   => $dir,        "title" => $CNCAT["plugins"]["static_pages"]["title"]    );}?>            <tr><td class="title"><?php print $CNCAT["lang"]["plugins"]?></td></tr>            <tr><td class="block">                <ul>                <?php foreach ($plugins_list as $plugin) {?>                    <li><?php if ($_GET["act"] == $plugin["act"]) {?>                        <?php print $plugin["title"]?>                    <?php } else {?>                        <a href="index.php?act=<?php print $plugin["act"]?>"><?php print $plugin["title"]?></a>                    <?php }?></li>                <?php }?>                </ul>            </td></tr>            <tr><td style="height: 10px;"></td></tr>            <tr><td class="title">"CN-Software" Ltd.</td></tr>            <tr><td class="block">                <a target="_blank" href="<?php print $CNCAT_SITE_URL?>">CNCat <?php print $CNCAT_PRODUCT_VERSION?></a>, Copyright &copy; 2002-<?php print date("Y")?>, &quot;CN-Software&quot; Ltd.            <?php if ($KEYACCEPTED && isAdmin()) {?>                <div  class="deline"></div>                <?php print $CNCAT["lang"]["license_type"]?>: <?php print $CN_TYPE?><br />                <?php print $CNCAT["lang"]["product_version"]?>: <?php print $CNCAT_PRODUCT_VERSION?><br />                    </td></tr>            <?php }?>        </table>    </td><td style="padding: 0 10px;"><?phpif (empty($_SERVER["QUERY_STRING"])) {        if ($data = @file_get_contents($CNCAT["system"]["dir_root"] . "cncat_ver.txt")) {        preg_match('/.+\((\d+)\).+$/im', $data, $m);        $build = $m[1];    }?>        <iframe width="500" scrolling="no" height="15" bgcolor="silver" frameborder="0" marginheight="0" marginwidth="0" hspace="0" vspace="0" src="http:/<?php echo '/'?>www.cn-software.com/info/cncat/?version=<?php print $CNCAT_PRODUCT_VERSION?>&build=<?php print $build?>&language=<?php print $CNCAT_SITE_LANG?>">        </iframe><?php}?>